"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8743],{5114:function(e,n,t){t.r(n),t.d(n,{assets:function(){return c},contentTitle:function(){return p},default:function(){return m},frontMatter:function(){return a},metadata:function(){return s},toc:function(){return u}});var r=t(3117),o=t(102),i=(t(7294),t(3905)),l=["components"],a={},p=void 0,s={unversionedId:"CloudNative/middleware/nginx",id:"CloudNative/middleware/nginx",title:"nginx",description:"Install",source:"@site/docs/CloudNative/middleware/nginx.md",sourceDirName:"CloudNative/middleware",slug:"/CloudNative/middleware/nginx",permalink:"/docs/CloudNative/middleware/nginx",draft:!1,tags:[],version:"current",lastUpdatedAt:1666271318,formattedLastUpdatedAt:"Oct 20, 2022",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"mysql\u66f4\u6539root\u5bc6\u7801",permalink:"/docs/CloudNative/middleware/mysql\u66f4\u6539root\u5bc6\u7801"},next:{title:"shadwosocks",permalink:"/docs/CloudNative/middleware/shadwosocks"}},c={},u=[{value:"Install",id:"install",level:3},{value:"Conf",id:"conf",level:3},{value:"gzip",id:"gzip",level:4},{value:"https/tls",id:"httpstls",level:4},{value:"h2",id:"h2",level:4},{value:"br",id:"br",level:4},{value:"onion",id:"onion",level:4},{value:"h3",id:"h3",level:4},{value:"Use",id:"use",level:3},{value:"\u6b63\u5411\u4ee3\u7406",id:"\u6b63\u5411\u4ee3\u7406",level:4},{value:"fe",id:"fe",level:5},{value:"be",id:"be",level:5},{value:"\u53cd\u5411\u4ee3\u7406",id:"\u53cd\u5411\u4ee3\u7406",level:4}],d={toc:u};function m(e){var n=e.components,t=(0,o.Z)(e,l);return(0,i.kt)("wrapper",(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h3",{id:"install"},"Install"),(0,i.kt)("p",null,"download"),(0,i.kt)("p",null,"make"),(0,i.kt)("h3",{id:"conf"},"Conf"),(0,i.kt)("h4",{id:"gzip"},"gzip"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"main.conf")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-properties"},'user  nginx;\nworker_processes  auto;\n\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\n\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    include       /etc/nginx/mime.types;\n    default_type  application/octet-stream;\n\n    log_format  main  \'$remote_addr - $remote_user [$time_local] "$request" \'\n                      \'$status $body_bytes_sent "$http_referer" \'\n                      \'"$http_user_agent" "$http_x_forwarded_for"\';\n\n    access_log  /var/log/nginx/access.log  main;\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    include /etc/nginx/conf.d/*.conf;\n}\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"default.conf")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-properties"},"server {\n    listen       80;\n    server_name  localhost;\n\n    #charset koi8-r;\n    #access_log  /var/log/nginx/host.access.log  main;\n\n    location / {\n        root   /usr/share/nginx/html;\n        index  index.html index.htm;\n    }\n\n    #error_page  404              /404.html;\n\n    # redirect server error pages to the static page /50x.html\n    #\n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n        root   /usr/share/nginx/html;\n    }\n\n    # proxy the PHP scripts to Apache listening on 127.0.0.1:80\n    #\n    #location ~ \\.php$ {\n    #    proxy_pass   http://127.0.0.1;\n    #}\n\n    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n    #\n    #location ~ \\.php$ {\n    #    root           html;\n    #    fastcgi_pass   127.0.0.1:9000;\n    #    fastcgi_index  index.php;\n    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;\n    #    include        fastcgi_params;\n    #}\n\n    # deny access to .htaccess files, if Apache's document root\n    # concurs with nginx's one\n    #\n    #location ~ /\\.ht {\n    #    deny  all;\n    #}\n}\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"gzip.conf")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-properties"},"# Gzip Settings\ngzip on;\ngzip_min_length 1k;\ngzip_buffers 4 16k;\ngzip_comp_level 5;\ngzip_types text/css text/xml text/plain image/jpeg image/gif image/png application/javascript application/json;\n")),(0,i.kt)("h4",{id:"httpstls"},"https/tls"),(0,i.kt)("h4",{id:"h2"},"h2"),(0,i.kt)("p",null,"http1.1 \u6700\u591a\u4e00\u6b21\u52a0\u8f7d 6 \u4e2a\u6587\u4ef6"),(0,i.kt)("p",null,"h2 \u6ca1\u6709\u8fd9\u4e2a\u9650\u5236"),(0,i.kt)("p",null,"\u901f\u5ea6\u66f4\u5feb\uff0c\u5bf9 TSL \u66f4\u53cb\u597d"),(0,i.kt)("h4",{id:"br"},"br"),(0,i.kt)("p",null,"\u9700\u8981\u6a21\u5757\u652f\u6301"),(0,i.kt)("p",null,"todo"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/google/ngx_brotli"},"https://github.com/google/ngx_brotli")),(0,i.kt)("h4",{id:"onion"},"onion"),(0,i.kt)("p",null,"todo"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://community.torproject.org/onion-services/"},"https://community.torproject.org/onion-services/")),(0,i.kt)("h4",{id:"h3"},"h3"),(0,i.kt)("p",null,"\u9700\u8981\u6a21\u5757\u652f\u6301"),(0,i.kt)("p",null,"todo"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://quic.nginx.org/README"},"https://quic.nginx.org/README")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/cloudflare/quiche/tree/master/nginx"},"https://github.com/cloudflare/quiche/tree/master/nginx")),(0,i.kt)("h3",{id:"use"},"Use"),(0,i.kt)("h4",{id:"\u6b63\u5411\u4ee3\u7406"},"\u6b63\u5411\u4ee3\u7406"),(0,i.kt)("h5",{id:"fe"},"fe"),(0,i.kt)("p",null,"rewrite"),(0,i.kt)("h5",{id:"be"},"be"),(0,i.kt)("p",null,"302 301"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"301")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-nginx"},'server {\n\n...\n\n# 301\n   if ($scheme != "https") {\n      return 301 https://$host$request_uri;\n   }\n}\n')),(0,i.kt)("h4",{id:"\u53cd\u5411\u4ee3\u7406"},"\u53cd\u5411\u4ee3\u7406"))}m.isMDXComponent=!0},3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return m}});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function a(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var p=r.createContext({}),s=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=s(e.components);return r.createElement(p.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,p=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),d=s(t),m=o,g=d["".concat(p,".").concat(m)]||d[m]||u[m]||i;return t?r.createElement(g,l(l({ref:n},c),{},{components:t})):r.createElement(g,l({ref:n},c))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,l=new Array(i);l[0]=d;var a={};for(var p in n)hasOwnProperty.call(n,p)&&(a[p]=n[p]);a.originalType=e,a.mdxType="string"==typeof e?e:o,l[1]=a;for(var s=2;s<i;s++)l[s]=t[s];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"}}]);